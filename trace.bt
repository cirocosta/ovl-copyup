#!/snap/bin/bpftrace

#include <linux/path.h>
#include <linux/dcache.h>

BEGIN
{
        printf("%-8s %-16s %-16s %s\n", "PID", "COMM", "NAME", "LEN(B)");
}


k:ovl_copy_up_data
/ comm == "a.out" /
{
        $old = (struct path*)arg0;

        printf("%-8d %-16s %-16s %d\n",
			pid,
			comm,
                        str($old->dentry->d_name.name),
                        arg2 >> 10);
}
